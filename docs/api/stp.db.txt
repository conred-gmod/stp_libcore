namespace stp.db;

-- Schemas

type .TableSchema = {
    var .IsTrait: bool
    var .Parent: nil | .TableSchema -- nil if .IsTrait == true, if not nil, .Parent.IsTrait must be == true

    
}

-- Lua-storage internals

internal struct ._LuaRow {
    -- Most of stuff is specified in schema of table

    var .[nonzero_uint]: any|nil -- Data
    var .Variant: uint -- Specifies type of struct (if high-level row is a trait). Zero if HLR is a struct.

    var .Table: .LuaTable
}

internal strict ._LuaTable {
    var .Schema: .TableSchema

    var .Rows: table(any, ._LuaRow) -- key type is specified by schema
}